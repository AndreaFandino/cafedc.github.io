---
output:
  html_document:
    df_print: paged
    includes:
      in_header: header.html
      before_body: hVastatrix.html
      after_body: citate.html
    css: styles.css
---
```{r, include=FALSE}
  library(ggplot2)
  library(dplyr)
```

```{r, include=FALSE}
  data <- DataBase_Markers_CENHV
```

```{r, include=FALSE}
  #Tabla de frecuencias por tipo
  type <- ftable(data$SSR_type)
  typeData <- as.data.frame(type)
  #secuencias frecuentes
  seque <- ftable(data$SSR_summary_sequence)
  sequeData <- as.data.frame(seque)
  sequeMain <- sequeData[sequeData$Freq > 2,]
  
```

```{r, echo=FALSE}
  # Pie plot
  typeData$fraction = typeData$Freq / sum(typeData$Freq)
  
  typeData$ymax = cumsum(typeData$fraction)
  
  typeData$ymin = c(0, head(typeData$ymax, n=-1))
  
  ggplot(typeData, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Var1)) +
     geom_rect() +
     coord_polar(theta="y") + # Try to remove that to understand how the chart is built initially
     xlim(c(2, 4)) # Try to remove that to see how to make a pie chart
```

```{r, echo=FALSE}
  #Barplot

  sequeMain$Var1 = with(sequeMain, reorder(Var1, Freq, .fun='length'))
  
  ggplot(sequeMain, aes(x=Var1, y=Freq, fill=Var1)) + 
    geom_col() +
    xlab("Sequences") + ylab ("Frequency") + ggtitle("Most Frequent Repeats")
```